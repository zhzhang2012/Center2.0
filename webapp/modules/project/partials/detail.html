<ng-include src="'modules/headers/partials/top.html'"></ng-include>

<!-- load Galleria -->
<script src="plugins/galleria/galleria-1.2.7.min.js"></script>

<!-- load the History plugin, no need for further scripting -->
<script src="plugins/galleria/plugins/history/galleria.history.min.js"></script>

<script type="text/javascript" src="js/plugin.js"></script>
<script type="text/javascript">

function CheckWord(textarea, span) {
    if (document.getElementById(textarea).value.length >= 200) {
        document.getElementById(span).innerHTML = 0;
    } else {
        document.getElementById(span).innerHTML = 200 - document.getElementById(textarea).value.length;
    }
}

$(document).ready(function () {

    var ProjectUser;
    var ProjectBudget;

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "Set_ClickTime", proid: id}
    });

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "Project_Photo", proid: id},
        success: function (returnJson) {
            var ProjectPhoto = JSON.parse(returnJson);

            if (ProjectPhoto.length > 0) {

                // Load the classic theme
                Galleria.loadTheme('plugins/galleria/themes/classic/galleria.classic.min.js');

                // Initialize Galleria
                Galleria.run('#galleria');

                for (var i = 0; i < ProjectPhoto.length; i++) {
                    $("#galleria").append("<a href=\"file/" + ProjectPhoto[i].FileUpload_FileName + "\">" +
                            "<img alt=\"" + ProjectPhoto[i].FileUpload_FileIntro + "\" src=\"file/" + ProjectPhoto[i].FileUpload_FileName + "\">" +
                            "</a>");
                }

            } else {
                $("#galleria").css("height", "auto");
                $("#ProjectView_Info_Photo").hide();
            }
        }
    });

    $("#ViewUpdateLink").attr("href", "ProjectUpdate_View.php?proid=" + id);
    $("#ViewDonateLink").attr("href", "User_Donate.php?func=view&proid=" + id);

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "Check_Favor", proid: id, uid: uid},
        success: function (returnJson) {
            var CheckFavor = JSON.parse(returnJson);

            if (CheckFavor.length > 0) {
                $("#ProToolBar_FavorSpan").html("<span class=\"HasFavored\">ÒÑÊÕ²Ø</span><span class=\"ProToolBar_FavorTime\"></span>");
            } else {
                $("#ProToolBar_FavorSpan").html("<a id=\"ProToolBar_Favor\">ÊÕ²Ø</a><span class=\"ProToolBar_FavorTime\"></span>");

                $("#ProToolBar_Favor").click(function () {
                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "Add_Favor", proid: id, uid: uid, class: "0"}
                    });

                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "Add_ProFavorTime", proid: id}
                    });

                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "User_EditScore", score: "5", uid: ProjectUser},
                        success: function () {
                            window.location.href = "User_MySpace.php?func=myfavor&page=1";
                        }
                    });

                });

            }

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "Favor_Rows", proid: id},
                success: function (returnRows) {
                    $(".ProToolBar_FavorTime").append(" - " + returnRows + " - ");
                }
            });

        }
    });

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "Check_FavorLike", proid: id, uid: uid},
        success: function (returnJson) {
            var CheckFavor = JSON.parse(returnJson);

            if (CheckFavor.length > 0) {
                $("#ProToolBar_LikeSpan").html("<span class=\"HasFavored\">ÒÑÔÞ</span><span class=\"ProToolBar_LikeTime\"></span>");
            } else {
                $("#ProToolBar_LikeSpan").html("<a id=\"ProToolBar_Like\">ÔÞ</a><span class=\"ProToolBar_LikeTime\"></span>");

                $("#ProToolBar_Like").click(function () {
                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "Add_FavorLike", proid: id, uid: uid, class: "1"}
                    });

                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "Add_ProFavorTime", proid: id}
                    });

                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "User_EditScore", score: "3", uid: ProjectUser},
                        success: function () {
                            location.reload();
                        }
                    });
                });


            }

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "FavorLike_Rows", proid: id},
                success: function (returnRows) {
                    $(".ProToolBar_LikeTime").append(" - " + returnRows + " - ");
                }
            });

        }
    });


    /***********************************************************************************************/

    var length;

    //×îÍâ²ãÆÀÂÛÊµÏÖÖ§³ÖºÍ·´¶Ô°´Å¥µÄº¯Êý

    function CommentLikeHate(LikeButton, HateButton, Order) {

        $("#" + LikeButton + i).click(function (e) {
            var LikeId = e.target.id;
            LikeId = LikeId.replace(LikeButton, "");

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                data: {action: "Find_Comment", pagenumber: page, pagesize: "10", number: LikeId, proid: id, order: Order},
                success: function (returnJson) {
                    var FindComment = JSON.parse(returnJson);

                    if (FindComment.length > 0) {
                        var CommentId = FindComment[0].ProComment_Id;
                        var CurrentLike = FindComment[0].ProComment_Like;

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            async: false,
                            data: {action: "Set_CommentTime", commentid: CommentId},
                            success: function (returnTime) {

                                if (returnTime == "1") {
                                    CurrentLike = parseInt(CurrentLike) + 1;

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Update_Comment", id: CommentId, col: "ProComment_Like", content: CurrentLike}
                                    });

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Show_Update_Comment", id: CommentId},
                                        success: function (returnJson) {
                                            var ShowUpdateComment = JSON.parse(returnJson);

                                            if (ShowUpdateComment.length > 0) {

                                                $("#" + LikeButton + LikeId).hide();
                                                $("#" + LikeButton + LikeId).empty();
                                                $("#" + LikeButton + LikeId).append("Ö§³Ö&nbsp;&nbsp;" + ShowUpdateComment[0].ProComment_Like);
                                                $("#" + LikeButton + LikeId).fadeIn(500);
                                            }

                                        }
                                    });

                                } else {
                                    $("#CommentVote_InfoDiv" + LikeId).fadeIn(200);

                                    setTimeout(function () {
                                        $("#CommentVote_InfoDiv" + LikeId).fadeOut(200);
                                    }, 3000);
                                }
                            }
                        });

                    }
                }
            });

        });

        $("#" + HateButton + i).click(function (e) {
            var HateId = e.target.id;
            HateId = HateId.replace(HateButton, "");

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                data: {action: "Find_Comment", pagenumber: page, pagesize: "10", number: HateId, proid: id, order: Order},
                success: function (returnJson) {
                    var FindComment = JSON.parse(returnJson);

                    if (FindComment.length > 0) {
                        var CommentId = FindComment[0].ProComment_Id;
                        var CurrentHate = FindComment[0].ProComment_Hate;

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            data: {action: "Set_CommentTime", commentid: CommentId},
                            success: function (returnTime) {

                                if (returnTime == "1") {
                                    CurrentHate = parseInt(CurrentHate) + 1;

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Update_Comment", id: CommentId, col: "ProComment_Hate", content: CurrentHate}
                                    });

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Show_Update_Comment", id: CommentId},
                                        success: function (returnJson) {
                                            var ShowUpdateComment = JSON.parse(returnJson);

                                            if (ShowUpdateComment.length > 0) {

                                                $("#" + HateButton + HateId).hide();
                                                $("#" + HateButton + HateId).empty();
                                                $("#" + HateButton + HateId).append("·´¶Ô&nbsp;&nbsp;" + ShowUpdateComment[0].ProComment_Hate);
                                                $("#" + HateButton + HateId).fadeIn(500);
                                            }

                                        }
                                    });

                                } else {
                                    $("#CommentVote_InfoDiv" + HateId).fadeIn(200);

                                    setTimeout(function () {
                                        $("#CommentVote_InfoDiv" + HateId).fadeOut(200);
                                    }, 3000);
                                }
                            }
                        });

                    }
                }
            });

        });

    }

    //Àï²ãÆÀÂÛÊµÏÖÖ§³ÖºÍ·´¶ÔµÄº¯Êý

    function ReplyLikeHate(LikeButton, RemoveLikeButton, HateButton, RemoveHateButton) {

        $("#" + LikeButton).click(function (e) {
            var LikeId = e.target.id;
            LikeId = LikeId.replace(RemoveLikeButton, "");

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                data: {action: "Show_Update_Comment", id: LikeId},
                success: function (returnJson) {
                    var FindComment = JSON.parse(returnJson);

                    if (FindComment.length > 0) {
                        var CommentId = FindComment[0].ProComment_Id;
                        var CurrentLike = FindComment[0].ProComment_Like;

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            data: {action: "Set_CommentTime", commentid: CommentId},
                            success: function (returnTime) {

                                if (returnTime == "1") {
                                    CurrentLike = parseInt(CurrentLike) + 1;

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Update_Comment", id: CommentId, col: "ProComment_Like", content: CurrentLike}
                                    });

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Show_Update_Comment", id: CommentId},
                                        success: function (returnJson) {
                                            var ShowUpdateComment = JSON.parse(returnJson);

                                            if (ShowUpdateComment.length > 0) {

                                                $("#" + LikeButton).hide();
                                                $("#" + LikeButton).empty();
                                                $("#" + LikeButton).append("Ö§³Ö&nbsp;&nbsp;" + ShowUpdateComment[0].ProComment_Like);
                                                $("#" + LikeButton).fadeIn(500);
                                            }

                                        }
                                    });

                                } else {
                                    $("#ReplyVote_InfoDiv" + LikeId).fadeIn(200);

                                    setTimeout(function () {
                                        $("#ReplyVote_InfoDiv" + LikeId).fadeOut(200);
                                    }, 3000);
                                }
                            }
                        });

                    }
                }
            });

        });

        $("#" + HateButton).click(function (e) {
            var HateId = e.target.id;
            HateId = HateId.replace(RemoveHateButton, "");

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                data: {action: "Show_Update_Comment", id: HateId},
                success: function (returnJson) {
                    var FindComment = JSON.parse(returnJson);

                    if (FindComment.length > 0) {
                        var CommentId = FindComment[0].ProComment_Id;
                        var CurrentHate = FindComment[0].ProComment_Hate;

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            data: {action: "Set_CommentTime", commentid: CommentId},
                            success: function (returnTime) {

                                if (returnTime == "1") {
                                    CurrentHate = parseInt(CurrentHate) + 1;

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Update_Comment", id: CommentId, col: "ProComment_Hate", content: CurrentHate}
                                    });

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Show_Update_Comment", id: CommentId},
                                        success: function (returnJson) {
                                            var ShowUpdateComment = JSON.parse(returnJson);

                                            if (ShowUpdateComment.length > 0) {

                                                $("#" + HateButton).hide();
                                                $("#" + HateButton).empty();
                                                $("#" + HateButton).append("·´¶Ô&nbsp;&nbsp;" + ShowUpdateComment[0].ProComment_Hate);
                                                $("#" + HateButton).fadeIn(500);
                                            }

                                        }
                                    });

                                } else {
                                    $("#ReplyVote_InfoDiv" + HateId).fadeIn(200);

                                    setTimeout(function () {
                                        $("#ReplyVote_InfoDiv" + HateId).fadeOut(200);
                                    }, 3000);
                                }
                            }
                        });

                    }
                }
            });

        });

    }

    //»Ø¸´ÁôÑÔµÄº¯Êý

    function ReplyFunction(ReplyOrder) {
        var ReplyLength;

        $.ajax({
            url: "BLL_AjaxSwitch.php",
            type: "POST",
            async: false,
            data: {action: "Reply_Rows", proid: id},
            success: function (returnJson) {
                ReplyLength = returnJson;
            }
        });

        for (var i = 0; i < ReplyLength; i++) {
            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "Show_One_Reply", proid: id, start: i},
                success: function (returnJson) {
                    var ShowReply = JSON.parse(returnJson);

                    if (ShowReply[0].ProComment_ParentId > 0) {
                        var ReplyId = ShowReply[0].ProComment_ParentId;

                        $("#Reply" + ReplyOrder + "Content" + ReplyId).append("<div class=\"ReplyOutside\">" +
                                "<div class=\"CommentPhoto_div\" id=\"CommentPhoto_div" + ReplyOrder + i + "\">" +
                                "</div>" +

                                "<div class=\"ReplyInfo\">" +
                                "<div class=\"CommentInfo_basic\">" +
                                "<div class=\"CommentInfo_basic1\">" +
                                "<span class=\"CommentName\" id=\"ReplyName_" + ReplyOrder + ShowReply[0].ProComment_Id + "\"></span>" +
                                "<span class=\"CommentDate\">" + ShowReply[0].ProComment_CreateDate + "</span>" +
                                "</div>" +

                                "<a class=\"ReplyHate\" id=\"Reply" + ReplyOrder + "_Hate" + ShowReply[0].ProComment_Id + "\">·´¶Ô&nbsp;&nbsp;" + ShowReply[0].ProComment_Hate + "</a>" +
                                "<a class=\"ReplyLike\" id=\"Reply" + ReplyOrder + "_Like" + ShowReply[0].ProComment_Id + "\">Ö§³Ö&nbsp;&nbsp;" + ShowReply[0].ProComment_Like + "</a>" +
                                "</div>" +

                                "<div class=\"ReplyInfo_content\">" +
                                ShowReply[0].ProComment_Content +
                                "</div>" +
                                "<div class=\"Reply" + ReplyOrder + "Content\" id=\"Reply" + ReplyOrder + "Content" + ShowReply[0].ProComment_Id + "\">" +
                                "</div>" +
                                "<div class=\"ReplyVote_InfoDiv\" id=\"ReplyVote_InfoDiv" + ShowReply[0].ProComment_Id + "\">" +
                                "<span class=\"CommentVote_Info\">ÄúÒÑ¾­Í¶¹ýÆ±ÁË</span>" +
                                "</div>" +
                                "<div class=\"ShowReply_buttonDiv\">" +
                                "<a class=\"CommentReply_button\" id=\"ShowReply" + ReplyOrder + "_button" + i + "\">»Ø ¸´</a>" +
                                "</div>" +
                                "<div class=\"ShowReply\" id=\"ShowReply" + ReplyOrder + i + "\">" +
                                "<textarea class=\"ShowReply_content\" id=\"ShowReply" + ReplyOrder + "_content" + i + "\" rows=\"4\" maxlength=\"200\" onkeydown=\"CheckWord('ShowReply" + ReplyOrder + "_content" + i + "','NewReply_WordCount" + i + "')\" onkeyup=\"CheckWord('ShowReply" + ReplyOrder + "_content" + i + "','NewReply_WordCount" + i + "')\"></textarea>" +
                                "<span class=\"ShowReply_info\">Äú»¹¿ÉÒÔÊäÈë <span id=\"NewReply_WordCount" + i + "\">200</span> ×Ö</span>" +
                                "<input type=\"hidden\" value=\"" + ShowReply[0].ProComment_Id + "\" id=\"ShowReply" + ReplyOrder + "_ParentId" + i + "\"/>" +
                                "<input type=\"hidden\" value=\"" + ShowReply[0].ProComment_Layout + "\" id=\"ShowReply" + ReplyOrder + "_Layout" + i + "\"/>" +
                                "<input type=\"button\" class=\"ShowReply_confirm\" id=\"ShowReply" + ReplyOrder + "_confirm" + i + "\" value=\"·¢ ²¼\"/>" +
                                "</div>" +
                                "</div>" +
                                "</div>");

                        ReplyLikeHate("Reply" + ReplyOrder + "_Like" + ShowReply[0].ProComment_Id, "Reply" + ReplyOrder + "_Like", "Reply" + ReplyOrder + "_Hate" + ShowReply[0].ProComment_Id, "Reply" + ReplyOrder + "_Hate");

                        $("#ShowReply" + ReplyOrder + i).hide();

                        if (ShowReply[0].ProComment_Layout >= 4) {
                            $("#ShowReply" + ReplyOrder + "_button" + i).hide();
                        }

                        $("#ShowReply" + ReplyOrder + "_button" + i).click(function () {
                            var ReplyDiv = $(this).attr("id");
                            ReplyDiv = ReplyDiv.replace("_button", "");
                            $("#" + ReplyDiv).slideToggle(500);
                        });

                        $("#ShowReply" + ReplyOrder + "_confirm" + i).mouseover(function () {
                            $(this).css("background-image", "url('Images/button4_over.png')");
                        });

                        $("#ShowReply" + ReplyOrder + "_confirm" + i).mouseout(function () {
                            $(this).css("background-image", "url('Images/button4.png')");
                        });

                        UserId = ShowReply[0].ProComment_Uid;

                        $("#CommentPhoto_div" + ReplyOrder + i).append("<img src=\"file/AvatarThumb_" + UserId + ".jpg\" class=\"CommentPhoto\">");

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            async: false,
                            data: {action: "UserInfo", uid: UserId},
                            success: function (returnUser) {
                                var CommentUser = JSON.parse(returnUser);

                                if (CommentUser.length > 0) {
                                    $("#ReplyName_" + ReplyOrder + ShowReply[0].ProComment_Id).append("<a class=\"UserPage_a\" href=\"User_Page.php?uid=" + CommentUser[0].UserInfo_Id + "\">" + CommentUser[0].UserInfo_Name + "</a>");
                                }
                            }
                        });

                        $("#ShowReply" + ReplyOrder + "_confirm" + i).click(function () {
                            var InputId = $(this).attr("id");
                            InputId = InputId.replace("ShowReply" + ReplyOrder + "_confirm", "");
                            var ParentId = document.getElementById("ShowReply" + ReplyOrder + "_ParentId" + InputId).value;
                            var Layout = document.getElementById("ShowReply" + ReplyOrder + "_Layout" + InputId).value;
                            Layout = parseInt(Layout) + 1;
                            var ReplyContent = document.getElementById("ShowReply" + ReplyOrder + "_content" + InputId).value;
                            var today = CurrentDate();

                            $.ajax({
                                url: "BLL_AjaxSwitch.php",
                                type: "POST",
                                data: {action: "Post_Comment", proid: id, parentid: ParentId, uid: uid, content: ReplyContent, createdate: today, layout: Layout},
                            });

                            $(".Reply" + ReplyOrder + "Content").empty();
                            ReplyFunction(ReplyOrder);

                        });

                    }
                }
            });
        }
    }

    $("#CommentList div").hide();
    $("#CommentList_Date").show();
    $("#CommentList_Date div").show();
    $(".CommentPage").show();
    $("#CommentNav ul li:first").addClass("select");
    $("#CommentNav ul li a").click(function () {
        $("#CommentNav ul li").removeClass("select");
        $(this).parent().addClass("select");
        var currentTab = $(this).attr('href');
        $("#CommentList div").hide();
        $(currentTab).show();
        $(currentTab + ' div').show();
        $(".CommentVote_InfoDiv").hide();
        $(".ReplyVote_InfoDiv").hide();
        $(".ShowReply").hide();
        $(".CommentReply").hide();
        $(".CommentPage").show();
        return false;
    });

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        async: false,
        data: {action: "Show_Comment", order: "ProComment_CreateDate", proid: id, pagenumber: page, pagesize: "10"},
        success: function (returnJson) {
            var ShowCommentDate = JSON.parse(returnJson);
            var UserId;

            if (ShowCommentDate.length > 0) {
                $("#CommentList_Date").empty();

                for (i = 0; i < ShowCommentDate.length; i++) {

                    if (ShowCommentDate[i].ProComment_ParentId == 0) {

                        $("#CommentList_Date").append("<div class=\"ShowComment\" id=\"Comment" + i + "\">" +
                                "<div class=\"CommentPhoto_div\" id=\"CommentPhotoDate_div" + i + "\">" +
                                "</div>" +

                                "<div class=\"CommentInfo\">" +
                                "<div class=\"CommentInfo_basic\">" +
                                "<div class=\"CommentInfo_basic1\">" +
                                "<span class=\"CommentName\" id=\"CommentName_Date" + i + "\"></span>" +
                                "<span class=\"CommentDate\">" + ShowCommentDate[i].ProComment_CreateDate + "</span>" +
                                "</div>" +

                            //"<div class=\"CommentInfo_basic2\">"+
                                "<a class=\"CommentLike\" id=\"CommentDate_Like" + i + "\">Ö§³Ö&nbsp;&nbsp;" + ShowCommentDate[i].ProComment_Like + "</a>" +
                                "<a class=\"CommentHate\" id=\"CommentDate_Hate" + i + "\">·´¶Ô&nbsp;&nbsp;" + ShowCommentDate[i].ProComment_Hate + "</a>" +
                            //"</div>"+
                                "</div>" +

                                "<div class=\"CommentInfo_content\">" +
                                ShowCommentDate[i].ProComment_Content +
                                "</div>" +

                                "<div class=\"ReplyDateContent\" id=\"ReplyDateContent" + ShowCommentDate[i].ProComment_Id + "\">" +
                                "</div>" +

                                "<div class=\"CommentVote_InfoDiv\" id=\"CommentVote_InfoDiv" + i + "\">" +
                                "<span class=\"CommentVote_Info\">ÄúÒÑ¾­Í¶¹ýÆ±ÁË</span>" +
                                "</div>" +

                                "<div class=\"CommentReply_buttonDiv\">" +
                                "<a class=\"CommentReply_button\" id=\"CommentReply_button" + i + "\">»Ø ¸´</a>" +
                                "</div>" +
                                "<div class=\"CommentReply\" id=\"CommentReply" + i + "\">" +
                                "<textarea class=\"CommentReply_content\" id=\"CommentReply_content" + i + "\" cols=\"76\" rows=\"4\" maxlength=\"200\" onkeydown=\"CheckWord('CommentReply_content" + i + "','NewCommentReply_WordCount" + i + "')\" onkeyup=\"CheckWord('CommentReply_content" + i + "','NewCommentReply_WordCount" + i + "')\"></textarea>" +
                                "<span class=\"CommentReply_info\">Äú»¹¿ÉÒÔÊäÈë <span id=\"NewCommentReply_WordCount" + i + "\">200</span> ×Ö</span>" +
                                "<input type=\"hidden\" value=\"" + ShowCommentDate[i].ProComment_Id + "\" id=\"CommentReply_ParentId" + i + "\"/>" +
                                "<input type=\"hidden\" value=\"" + ShowCommentDate[i].ProComment_Layout + "\" id=\"CommentReply_Layout" + i + "\"/>" +
                                "<input type=\"button\" class=\"CommentReply_confirm\" id=\"CommentReply_confirm" + i + "\" value=\"·¢ ²¼\"/>" +
                                "</div>" +
                                "</div>" +
                                "</div>");

                        $("#CommentReply" + i).hide();
                        $("#CommentReply_button" + i).click(function () {
                            var ReplyDiv = $(this).attr("id");
                            ReplyDiv = ReplyDiv.replace("_button", "");
                            $("#" + ReplyDiv).slideToggle(500);
                        });

                        $("#CommentReply_confirm" + i).mouseover(function () {
                            $(this).css("background-image", "url('Images/button4_over.png')");
                        });

                        $("#CommentReply_confirm" + i).mouseout(function () {
                            $(this).css("background-image", "url('Images/button4.png')");
                        });

                        UserId = ShowCommentDate[i].ProComment_Uid;

                        $("#CommentPhotoDate_div" + i).append("<img src=\"file/AvatarThumb_" + UserId + ".jpg\" class=\"CommentPhoto\">");

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            async: false,
                            data: {action: "UserInfo", uid: UserId},
                            success: function (returnUser) {
                                var CommentUser = JSON.parse(returnUser);

                                if (CommentUser.length > 0) {
                                    $("#CommentName_Date" + i).append("<a class=\"UserPage_a\" href=\"User_Page.php?uid=" + CommentUser[0].UserInfo_Id + "\">" + CommentUser[0].UserInfo_Name + "</a>");
                                }
                            }
                        });

                        CommentLikeHate("CommentDate_Like", "CommentDate_Hate", "ProComment_CreateDate");

                        $("#CommentReply_confirm" + i).click(function () {
                            var InputId = $(this).attr("id");
                            InputId = InputId.replace("CommentReply_confirm", "");
                            var ParentId = document.getElementById("CommentReply_ParentId" + InputId).value;
                            var Layout = document.getElementById("CommentReply_Layout" + InputId).value;
                            Layout += 1;
                            var ReplyContent = document.getElementById("CommentReply_content" + InputId).value;
                            var today = CurrentDate();

                            $.ajax({
                                url: "BLL_AjaxSwitch.php",
                                type: "POST",
                                data: {action: "Post_Comment", proid: id, parentid: ParentId, uid: uid, content: ReplyContent, createdate: today, layout: Layout},
                            });

                            $(".ReplyDateContent").empty();

                            ReplyFunction("Date");

                            document.getElementById("CommentReply_content" + InputId).value = "";
                        });

                    }
                }

                ReplyFunction("Date");

            } else {
                $("#CommentList_Date").empty();
                $("#CommentList_Date").append("<span class=\"NoComment\">Ä¿Ç°»¹Ã»ÓÐÈÎºÎÁôÑÔ</span>");
                $(".CommentPage").hide();
            }
        }
    });

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "Show_Comment", order: "ProComment_Like", proid: id, pagenumber: page, pagesize: "10"},
        success: function (returnJson) {
            var ShowCommentLike = JSON.parse(returnJson);
            var UserId;

            if (ShowCommentLike.length > 0) {
                $("#CommentList_Like").empty();

                for (i = 0; i < ShowCommentLike.length; i++) {

                    $("#CommentList_Like").append("<div class=\"ShowComment\" id=\"Comment" + i + "\">" +
                            "<div class=\"CommentPhoto_div\" id=\"CommentPhotoLike_div" + i + "\">" +
                            "</div>" +

                            "<div class=\"CommentInfo\">" +
                            "<div class=\"CommentInfo_basic\">" +
                            "<div class=\"CommentInfo_basic1\">" +
                            "<span class=\"CommentName\" id=\"CommentName_Like" + i + "\"></span>" +
                            "<span class=\"CommentDate\">" + ShowCommentLike[i].ProComment_CreateDate + "</span>" +
                            "</div>" +

                        //"<div class=\"CommentInfo_basic2\">"+
                            "<a class=\"CommentLike\" id=\"CommentLike_Like" + i + "\">Ö§³Ö&nbsp;&nbsp;" + ShowCommentLike[i].ProComment_Like + "</a>" +
                            "<a class=\"CommentHate\" id=\"CommentLike_Hate" + i + "\">·´¶Ô&nbsp;&nbsp;" + ShowCommentLike[i].ProComment_Hate + "</a>" +
                        //"</div>"+
                            "</div>" +
                            "<div class=\"CommentInfo_content\">" +
                            ShowCommentLike[i].ProComment_Content +
                            "</div>" +

                            "<div class=\"ReplyLikeContent\" id=\"ReplyLikeContent" + ShowCommentLike[i].ProComment_Id + "\">" +
                            "</div>" +

                            "<div class=\"CommentVote_InfoDiv\" id=\"CommentVote_InfoDiv" + i + "\">" +
                            "<span class=\"CommentVote_Info\">ÄúÒÑ¾­Í¶¹ýÆ±ÁË</span>" +
                            "</div>" +

                            "<div class=\"CommentReply_buttonDiv\">" +
                            "<a class=\"CommentReply_button\" id=\"CommentLikeReply_button" + i + "\">»Ø ¸´</a>" +
                            "</div>" +
                            "<div class=\"CommentReply\" id=\"CommentLikeReply" + i + "\">" +
                            "<textarea class=\"CommentReply_content\" id=\"CommentLikeReply_content" + i + "\" cols=\"76\" rows=\"4\" maxlength=\"200\" onkeydown=\"CheckWord('CommentLikeReply_content" + i + "','NewLikeCommentReply_WordCount" + i + "')\" onkeyup=\"CheckWord('CommentLikeReply_content" + i + "','NewLikeCommentReply_WordCount" + i + "')\"></textarea>" +
                            "<span class=\"CommentReply_info\">Äú»¹¿ÉÒÔÊäÈë  <span id=\"NewLikeCommentReply_WordCount" + i + "\">200</span> ×Ö</span>" +
                            "<input type=\"hidden\" value=\"" + ShowCommentLike[i].ProComment_Id + "\" id=\"CommentLikeReply_ParentId" + i + "\"/>" +
                            "<input type=\"hidden\" value=\"" + ShowCommentLike[i].ProComment_Layout + "\" id=\"CommentLikeReply_Layout" + i + "\"/>" +
                            "<input type=\"button\" class=\"CommentReply_confirm\" id=\"CommentLikeReply_confirm" + i + "\" value=\"·¢ ²¼\"/>" +
                            "</div>" +
                            "</div>" +
                            "</div>");

                    $("#CommentLikeReply" + i).hide();
                    $("#CommentLikeReply_button" + i).click(function () {
                        var ReplyDiv = $(this).attr("id");
                        ReplyDiv = ReplyDiv.replace("_button", "");
                        $("#" + ReplyDiv).slideToggle(500);
                    });

                    $("#CommentLikeReply_confirm" + i).mouseover(function () {
                        $(this).css("background-image", "url('Images/button4_over.png')");
                    });

                    $("#CommentLikeReply_confirm" + i).mouseout(function () {
                        $(this).css("background-image", "url('Images/button4.png')");
                    });

                    UserId = ShowCommentLike[i].ProComment_Uid;

                    $("#CommentPhotoLike_div" + i).append("<img src=\"file/AvatarThumb_" + UserId + ".jpg\" class=\"CommentPhoto\">");

                    $.ajax({
                        url: "BLL_AjaxSwitch.php",
                        type: "POST",
                        async: false,
                        data: {action: "UserInfo", uid: UserId},
                        success: function (returnUser) {
                            var CommentUser = JSON.parse(returnUser);

                            if (CommentUser.length > 0) {
                                $("#CommentName_Like" + i).append("<a class=\"UserPage_a\" href=\"User_Page.php?uid=" + CommentUser[0].UserInfo_Id + "\">" + CommentUser[0].UserInfo_Name + "</a>");
                            }
                        }
                    });

                    CommentLikeHate("CommentLike_Like", "CommentLike_Hate", "ProComment_Like");

                    $("#CommentLikeReply_confirm" + i).click(function () {
                        var InputId = $(this).attr("id");
                        InputId = InputId.replace("CommentLikeReply_confirm", "");
                        var ParentId = document.getElementById("CommentLikeReply_ParentId" + InputId).value;
                        var Layout = document.getElementById("CommentReplyLike_Layout" + InputId).value;
                        Layout += 1;
                        var ReplyContent = document.getElementById("CommentLikeReply_content" + InputId).value;
                        var today = CurrentDate();

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            data: {action: "Post_Comment", proid: id, parentid: ParentId, uid: uid, content: ReplyContent, createdate: today, layout: Layout},
                        });

                        $(".ReplyLikeContent").empty();
                        ReplyFunction("Like");

                        document.getElementById("CommentReply_content" + InputId).value = "";

                    });

                }

                ReplyFunction("Like");

            } else {
                $("#CommentList_Like").empty();
                $("#CommentList_Like").append("<span class=\"NoComment\">Ä¿Ç°»¹Ã»ÓÐÈÎºÎÁôÑÔ</span>");
                $(".CommentPage").hide();
            }
        }
    });


    ShowCo();
    $('#VeriCoRefr').click(function () {
        ShowCo();
    });
    function ShowCo() {
        num = ''; //define num as String
        for (i = 0; i < 4; i++) {
            tmp = Math.ceil((Math.random() * 15));//Math.random returns random value between 0 && 1; Math.ceil rounds the number upward to its nearest integer;
            if (tmp > 9) {
                switch (tmp) {
                    case(10):
                        num += 'A';
                        break;
                    case(11):
                        num += 'B';
                        break;
                    case(12):
                        num += 'C';
                        break;
                    case(13):
                        num += 'D';
                        break;
                    case(14):
                        num += 'E';
                        break;
                    case(15):
                        num += 'F';
                        break;
                }
            } else {
                num += tmp;
            }
            $('#VeriCoHol').attr('src', 'VeriCoGen.php?num=' + num);
        }
    }

    $("#CommentCreate_button").mouseover(function () {
        $(this).css("background-image", "url('Images/button1_over.png')");
    });

    $("#CommentCreate_button").mouseout(function () {
        $(this).css("background-image", "url('Images/button1.png')");
    });

    $("#CommentCreate_button").click(function () {

        if ($('#RanCoInp').val() !== num) {
            $('#AlertVeriFalse').html('ÑéÖ¤Âë´íÎó£¡');
        } else {

            var today = CurrentDate();
            var content = document.getElementById("NewComment").value;

            document.getElementById("NewComment").value = "";
            document.getElementById("RanCoInp").value = "";

            ShowCo();

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "Post_Comment", proid: id, parentid: "0", uid: uid, content: content, createdate: today, layout: "0"},
            });

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "Show_Comment", order: "ProComment_CreateDate", proid: id, pagenumber: page, pagesize: "10"},
                success: function (returnJson) {
                    var ShowCommentDate = JSON.parse(returnJson);
                    var UserId;

                    if (ShowCommentDate.length > 0) {
                        $("#CommentList_Date").empty();

                        for (i = 0; i < ShowCommentDate.length; i++) {

                            if (ShowCommentDate[i].ProComment_ParentId == 0) {

                                $("#CommentList_Date").append("<div class=\"ShowComment\" id=\"Comment" + i + "\">" +
                                        "<div class=\"CommentPhoto_div\" id=\"CommentPhotoDate_div" + i + "\">" +
                                        "</div>" +

                                        "<div class=\"CommentInfo\">" +
                                        "<div class=\"CommentInfo_basic\">" +
                                        "<div class=\"CommentInfo_basic1\">" +
                                        "<span class=\"CommentName\" id=\"CommentName_Date" + i + "\"></span>" +
                                        "<span class=\"CommentDate\">" + ShowCommentDate[i].ProComment_CreateDate + "</span>" +
                                        "</div>" +

                                    //"<div class=\"CommentInfo_basic2\">"+
                                        "<a class=\"CommentLike\" id=\"CommentDate_Like" + i + "\">Ö§³Ö&nbsp;&nbsp;" + ShowCommentDate[i].ProComment_Like + "</a>" +
                                        "<a class=\"CommentHate\" id=\"CommentDate_Hate" + i + "\">·´¶Ô&nbsp;&nbsp;" + ShowCommentDate[i].ProComment_Hate + "</a>" +
                                    //"</div>"+
                                        "</div>" +

                                        "<div class=\"CommentInfo_content\">" +
                                        ShowCommentDate[i].ProComment_Content +
                                        "</div>" +

                                        "<div class=\"ReplyDateContent\" id=\"ReplyDateContent" + ShowCommentDate[i].ProComment_Id + "\">" +
                                        "</div>" +

                                        "<div class=\"CommentVote_InfoDiv\" id=\"CommentVote_InfoDiv" + i + "\">" +
                                        "<span class=\"CommentVote_Info\">ÄúÒÑ¾­Í¶¹ýÆ±ÁË</span>" +
                                        "</div>" +

                                        "<div class=\"CommentReply_buttonDiv\">" +
                                        "<a class=\"CommentReply_button\" id=\"CommentReply_button" + i + "\">»Ø ¸´</a>" +
                                        "</div>" +
                                        "<div class=\"CommentReply\" id=\"CommentReply" + i + "\">" +
                                        "<textarea class=\"CommentReply_content\" id=\"CommentReply_content" + i + "\" cols=\"76\" rows=\"4\" maxlength=\"200\" onkeydown=\"CheckWord('CommentReply_content" + i + "','NewCommentReply_WordCount" + i + "')\" onkeyup=\"CheckWord('CommentReply_content" + i + "','NewCommentReply_WordCount" + i + "')\"></textarea>" +
                                        "<span class=\"CommentReply_info\">Äú»¹¿ÉÒÔÊäÈë  <span id=\"NewCommentReply_WordCount" + i + "\">200</span> ×Ö</span>" +
                                        "<input type=\"hidden\" value=\"" + ShowCommentDate[i].ProComment_Id + "\" id=\"CommentReply_ParentId" + i + "\"/>" +
                                        "<input type=\"hidden\" value=\"" + ShowCommentDate[i].ProComment_Layout + "\" id=\"CommentReply_Layout" + i + "\"/>" +
                                        "<input type=\"button\" class=\"CommentReply_confirm\" id=\"CommentReply_confirm" + i + "\" value=\"·¢ ²¼\"/>" +
                                        "</div>" +
                                        "</div>" +
                                        "</div>");

                                $("#CommentReply" + i).hide();
                                $("#CommentReply_button" + i).click(function () {
                                    var ReplyDiv = $(this).attr("id");
                                    ReplyDiv = ReplyDiv.replace("_button", "");
                                    $("#" + ReplyDiv).slideToggle(500);
                                });

                                $("#CommentReply_confirm" + i).mouseover(function () {
                                    $(this).css("background-image", "url('Images/button4_over.png')");
                                });

                                $("#CommentReply_confirm" + i).mouseout(function () {
                                    $(this).css("background-image", "url('Images/button4.png')");
                                });

                                UserId = ShowCommentDate[i].ProComment_Uid;

                                $("#CommentPhotoDate_div" + i).append("<img src=\"file/AvatarThumb_" + UserId + ".jpg\" class=\"CommentPhoto\">");

                                $.ajax({
                                    url: "BLL_AjaxSwitch.php",
                                    type: "POST",
                                    async: false,
                                    data: {action: "UserInfo", uid: UserId},
                                    success: function (returnUser) {
                                        var CommentUser = JSON.parse(returnUser);

                                        if (CommentUser.length > 0) {
                                            $("#CommentName_Date" + i).append("<a class=\"UserPage_a\" href=\"User_Page.php?uid=" + CommentUser[0].UserInfo_Id + "\">" + CommentUser[0].UserInfo_Name + "</a>");
                                        }
                                    }
                                });

                                CommentLikeHate("CommentDate_Like", "CommentDate_Hate", "ProComment_CreateDate");

                                $("#CommentReply_confirm" + i).click(function () {
                                    var InputId = $(this).attr("id");
                                    InputId = InputId.replace("CommentReply_confirm", "");
                                    var ParentId = document.getElementById("CommentReply_ParentId" + InputId).value;
                                    var Layout = document.getElementById("CommentReply_Layout" + InputId).value;
                                    Layout += 1;
                                    var ReplyContent = document.getElementById("CommentReply_content" + InputId).value;
                                    var today = CurrentDate();

                                    $.ajax({
                                        url: "BLL_AjaxSwitch.php",
                                        type: "POST",
                                        async: false,
                                        data: {action: "Post_Comment", proid: id, parentid: ParentId, uid: uid, content: ReplyContent, createdate: today, layout: Layout},
                                    });

                                    $(".ReplyDateContent").empty();

                                    ReplyFunction("Date");

                                    document.getElementById("CommentReply_content" + InputId).value = "";

                                });

                            }
                        }

                        ReplyFunction("Date");

                    } else {
                        $("#CommentList_Date").empty();
                        $("#CommentList_Date").append("<span class=\"NoComment\">Ä¿Ç°»¹Ã»ÓÐÈÎºÎÁôÑÔ</span>");
                        $(".CommentPage").hide();
                    }
                }
            });

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                data: {action: "Show_Comment", order: "ProComment_Like", proid: id, pagenumber: page, pagesize: "10"},
                success: function (returnJson) {
                    var ShowCommentLike = JSON.parse(returnJson);
                    var UserId;

                    if (ShowCommentLike.length > 0) {
                        $("#CommentList_Like").empty();

                        for (i = 0; i < ShowCommentLike.length; i++) {

                            $("#CommentList_Like").append("<div class=\"ShowComment\" id=\"Comment" + i + "\">" +
                                    "<div class=\"CommentPhoto_div\" id=\"CommentPhotoLike_div" + i + "\">" +
                                    "</div>" +

                                    "<div class=\"CommentInfo\">" +
                                    "<div class=\"CommentInfo_basic\">" +
                                    "<div class=\"CommentInfo_basic1\">" +
                                    "<span class=\"CommentName\" id=\"CommentName_Like" + i + "\"></span>" +
                                    "<span class=\"CommentDate\">" + ShowCommentLike[i].ProComment_CreateDate + "</span>" +
                                    "</div>" +

                                //"<div class=\"CommentInfo_basic2\">"+
                                    "<a class=\"CommentLike\" id=\"CommentLike_Like" + i + "\">Ö§³Ö&nbsp;&nbsp;" + ShowCommentLike[i].ProComment_Like + "</a>" +
                                    "<a class=\"CommentHate\" id=\"CommentLike_Hate" + i + "\">·´¶Ô&nbsp;&nbsp;" + ShowCommentLike[i].ProComment_Hate + "</a>" +
                                //"</div>"+
                                    "</div>" +
                                    "<div class=\"CommentInfo_content\">" +
                                    ShowCommentLike[i].ProComment_Content +
                                    "</div>" +

                                    "<div class=\"ReplyLikeContent\" id=\"ReplyLikeContent" + ShowCommentLike[i].ProComment_Id + "\">" +
                                    "</div>" +

                                    "<div class=\"CommentVote_InfoDiv\" id=\"CommentVote_InfoDiv" + i + "\">" +
                                    "<span class=\"CommentVote_Info\">ÄúÒÑ¾­Í¶¹ýÆ±ÁË</span>" +
                                    "</div>" +

                                    "<div class=\"CommentReply_buttonDiv\">" +
                                    "<a class=\"CommentReply_button\" id=\"CommentLikeReply_button" + i + "\">»Ø ¸´</a>" +
                                    "</div>" +
                                    "<div class=\"CommentReply\" id=\"CommentLikeReply" + i + "\">" +
                                    "<textarea class=\"CommentReply_content\" id=\"CommentLikeReply_content" + i + "\" cols=\"76\" rows=\"4\" maxlength=\"200\" onkeydown=\"CheckWord('CommentLikeReply_content" + i + "','NewLikeCommentReply_WordCount" + i + "')\" onkeyup=\"CheckWord('CommentLikeReply_content" + i + "','NewLikeCommentReply_WordCount" + i + "')\"></textarea>" +
                                    "<span class=\"CommentReply_info\">Äú»¹¿ÉÒÔÊäÈë  <span id=\"NewLikeCommentReply_WordCount" + i + "\">200</span> ×Ö</span>" +
                                    "<input type=\"hidden\" value=\"" + ShowCommentLike[i].ProComment_Id + "\" id=\"CommentLikeReply_ParentId" + i + "\"/>" +
                                    "<input type=\"hidden\" value=\"" + ShowCommentLike[i].ProComment_Layout + "\" id=\"CommentLikeReply_Layout" + i + "\"/>" +
                                    "<input type=\"button\" class=\"CommentReply_confirm\" id=\"CommentLikeReply_confirm" + i + "\" value=\"·¢ ²¼\"/>" +
                                    "</div>" +
                                    "</div>" +
                                    "</div>");

                            $("#CommentLikeReply" + i).hide();
                            $("#CommentLikeReply_button" + i).click(function () {
                                var ReplyDiv = $(this).attr("id");
                                ReplyDiv = ReplyDiv.replace("_button", "");
                                $("#" + ReplyDiv).slideToggle(500);
                            });

                            $("#CommentLikeReply_confirm" + i).mouseover(function () {
                                $(this).css("background-image", "url('Images/button4_over.png')");
                            });

                            $("#CommentLikeReply_confirm" + i).mouseout(function () {
                                $(this).css("background-image", "url('Images/button4.png')");
                            });

                            UserId = ShowCommentLike[i].ProComment_Uid;

                            $("#CommentPhotoLike_div" + i).append("<img src=\"file/AvatarThumb_" + UserId + ".jpg\" class=\"CommentPhoto\">");

                            $.ajax({
                                url: "BLL_AjaxSwitch.php",
                                type: "POST",
                                async: false,
                                data: {action: "UserInfo", uid: UserId},
                                success: function (returnUser) {
                                    var CommentUser = JSON.parse(returnUser);

                                    if (CommentUser.length > 0) {
                                        $("#CommentName_Like" + i).append("<a class=\"UserPage_a\" href=\"User_Page.php?uid=" + CommentUser[0].UserInfo_Id + "\">" + CommentUser[0].UserInfo_Name + "</a>");
                                    }
                                }
                            });

                            CommentLikeHate("CommentLike_Like", "CommentLike_Hate", "ProComment_Like");

                            $("#CommentLikeReply_confirm" + i).click(function () {
                                var InputId = $(this).attr("id");
                                InputId = InputId.replace("CommentLikeReply_confirm", "");
                                var ParentId = document.getElementById("CommentLikeReply_ParentId" + InputId).value;
                                var Layout = document.getElementById("CommentLikeReply_Layout" + InputId).value;
                                Layout += 1;
                                var ReplyContent = document.getElementById("CommentLikeReply_content" + InputId).value;
                                var today = CurrentDate();

                                $.ajax({
                                    url: "BLL_AjaxSwitch.php",
                                    type: "POST",
                                    async: false,
                                    data: {action: "Post_Comment", proid: id, parentid: ParentId, uid: uid, content: ReplyContent, createdate: today, layout: Layout},
                                });

                                $(".ReplyLikeContent").empty();

                                ReplyFunction("Like");

                                document.getElementById("CommentReply_content" + InputId).value = "";

                            });

                        }

                        ReplyFunction("Like");

                    } else {
                        $("#CommentList_Like").empty();
                        $("#CommentList_Like").append("<span class=\"NoComment\">Ä¿Ç°»¹Ã»ÓÐÈÎºÎÁôÑÔ</span>");
                        $(".CommentPage").hide();
                    }
                }
            });
        }

    });

    $("#CommentNav_Create").mouseover(function () {
        $(this).css("background-image", "url('Images/button1_over.png')");
    });

    $("#CommentNav_Create").mouseout(function () {
        $(this).css("background-image", "url('Images/button1.png')");
    });

    $.ajax({
        url: "BLL_AjaxSwitch.php",
        type: "POST",
        data: {action: "UserInfo", uid: uid},
        success: function (returnUser) {
            var Donator = JSON.parse(returnUser);
            var DonatorStatus = Donator[0].UserInfo_Status;

            $.ajax({
                url: "BLL_AjaxSwitch.php",
                type: "POST",
                async: false,
                data: {action: "Project_View", id: id},
                success: function (returnJson) {
                    var ProjectInfo = JSON.parse(returnJson);
                    var ProjectStatus = ProjectInfo[0].ProInfo_Status;

                    if (ProjectStatus == 5 && DonatorStatus == 1) {

                        $.ajax({
                            url: "BLL_AjaxSwitch.php",
                            type: "POST",
                            async: false,
                            data: {action: "Check_DonateRows", uid: uid},
                            success: function (returnRows) {
                                var DonateNumber = returnRows;

                                if (DonateNumber >= 3) {
                                    $("#GoDonateSpan").append("ÇëÏÈÍê³ÉÕýÔÚ½øÐÐÖÐµÄÏîÄ¿");
                                    $("#GoDonateSpan").css("font-size", "12px");
                                    $("#GoDonate").css("cursor", "default");
                                } else {
                                    $("#GoDonateSpan").append("Ç°È¥¾è¿î");
                                    $("#GoDonate").attr("href", "User_Donate.php?func=donate&proid=" + id);
                                }
                            }
                        });

                    } else if (ProjectStatus == 5 && DonatorStatus != 1) {
                        $("#GoDonateSpan").append("ÄúÔÝÊ±ÎÞ·¨¾è¿î");
                        $("#GoDonateSpan").css("font-size", "12px");
                        $("#GoDonate").css("cursor", "default");

                    } else if (ProjectStatus != 5) {
                        $("#GoDonateSpan").append("ÒÑÓÐÐ£ÓÑÈÏ¾è");
                        $("#GoDonate").css("cursor", "default");
                        $("#GoDonateSpan").css("font-size", "12.5px");
                    }
                }
            });

        }
    });

});

</script>


<div id="ProView">
    <div class="Filter-sub">
        <ul class="path-sub">
            <li id="sub_index"><a href="Index.php">主页</a><span></span></li>
            <li id="sub_unfinish"><a href="ProjectInfo_List.php?status=0&type=0&order=0&page=1">浏览项目</a><span></span>
            </li>
            <li id="sub_title"><a href="#">查看项目</a><span></span></li>
        </ul>
        <div class="TitleHelper"></div>
    </div>
    <div id="GoAndProSys">
        <a id="GoDonate" href="#"><span id="GoDonateSpan"></span></a>
    </div>
    <div id="GoAndPhoto">
        <a id="ViewUpdateLink" href="#"><span id="ViewUpdate">查看更新</span></a>
    </div>
    <table class="floor">
        <tbody>
        <tr>
            <td class="floor-left" valign="top">
                <div class="SideBar">

                    <div class="UserName">
                        {{ projectData.Stu_Name_ }}
                    </div>
                    <div id="UserPhoto">
                    </div>
                    <div class="UserNumberDiv">
                        <span class="UserNumber">学籍号：</span>
                    </div>
                    <div class="Separate">
                        申请人简介
                    </div>
                    <div id="StudentIntro">
                        {{ projectData.Stu_Info_ }}
                    </div>
                    <div class="Separate">
                        联络信息
                    </div>
                    <div id="ContactInfo">
                        <ul>
                            <li id="ContactInfo_Email"><span class="ContactInfo_Info">邮箱：</span></li>
                            <li id="ContactInfo_Tel"><span class="ContactInfo_Info">家庭电话：</span></li>
                            <li id="ContactInfo_Cell"><span class="ContactInfo_Info">手机：</span></li>
                            <li id="ContactInfo_ParentTel"><span class="ContactInfo_Info">家长电话：</span></li>
                            <li id="ContactInfo_QQ"><span class="ContactInfo_Info">QQ：</span></li>
                        </ul>
                    </div>
                    <div class="Separate">
                        捐款信息
                    </div>
                    <div id="ViewDonateInfo">
                        <span id="ViewDonateInfo_Number"></span>
                        <span id="ViewDonateInfo_Date">截止日期：</span>
                    </div>
                    <div class="margin"></div>
                </div>
            </td>
            <td class="floor-right" valign="top">
                <div class="MainBar">
                    <div id="Title">
                        <h1 id="ProTitle">{{ projectData.Project_Title_ }}</h1>

                        <div class="ProToolBar">
                            <div id="ProToolBar_Class">{{ projectData.Project_Class_ }}
                            </div>
                            <div id="ProToolBar_ApplyDate">{{ projectData.createdAt }}
                            </div>
                            <div id="ProToolBar_Tool">
                                <span id="ProToolBar_FavorSpan"></span>

                                <div class="ProToolBar_LikeDiv">
                                    <img class="ProLikeImg" src="Images/ProLike.png">
                                    <span id="ProToolBar_LikeSpan"></span>
                                </div>
                            </div>
                        </div>
                        <div class="TitleHelper"></div>
                        <div class="TitleHelper"></div>
                    </div>

                    <span class="ProjectView_Info" id="ProjectView_Info_Photo"><img src="Images/decorate_left.png"
                                                                                    width="30px" height="10px">&nbsp;图片精选&nbsp;<img
                            src="Images/decorate_right.png" width="30px" height="10px"></span>

                    <div id="ProjectPhoto">
                        <div id="galleria">

                        </div>
                    </div>

                    <span class="ProjectView_Info"><img src="Images/decorate_left.png" width="30px" height="10px">&nbsp;详细信息&nbsp;<img
                            src="Images/decorate_right.png" width="30px" height="10px"></span>

                    <div id="ProjectView_Nav">
                        <ul>
                            <li><a href="#ProInfo">项目介绍</a></li>
                            <li><a href="#ProPlan">项目计划</a></li>
                            <li><a href="#ProGoal">项目目标</a></li>
                        </ul>
                    </div>

                    <div id="ProjectView_Content">
                        <div id="ProInfo" class="Passage">
                            {{ projectData.Project_Intro_ }}
                        </div>
                        <div id="ProPlan" class="Passage">
                            {{ projectData.Project_Plan_ }}
                        </div>
                        <div id="ProGoal" class="Passage">
                            {{ projectData.Project_Goal_ }}
                        </div>
                    </div>

                    <span class="ProjectView_Info"><img src="Images/decorate_left.png" width="30px" height="10px">&nbsp;申请金额明细&nbsp;<img
                            src="Images/decorate_right.png" width="30px" height="10px"></span>

                    <div id="ProBudget">
                        <table id="ProBudget_table">
                            <tr>
                                <th scope="col" class="Name">物品/活动名称</th>
                                <th scope="col" class="Price">单价</th>
                                <th scope="col" class="Amount">数量</th>
                                <th scope="col" class="Remark">备注</th>
                            </tr>
                            <tbody id="ProBudget_tbody">
                                <tr ng-repeat="item in projectData.Budgets_List_">
                                    <td>{{ item.name }}</td>
                                    <td>{{ item.price }}</td>
                                    <td>{{ item.amount }}</td>
                                    <td>{{ item.remark }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div id="marginHelper">
                    </div>
                </div>

                <ng-include src="'modules/comment/partials/comment.html'"></ng-include>

            </td>
        </tr>
        </tbody>
    </table>
</div>

<ng-include src="'modules/headers/partials/bottom.html'"></ng-include>